# Terraform (локальная инфраструктура)

> **Важно!**
> Из-за санкций, официальный реестр плагинов Terraform ([registry.terraform.io](https://registry.terraform.io/)) недоступен. Рабочее решение — использовать зеркала, как описано в статье: [Разворачиваем без боли Terraform в Яндекс облаке (Habr)](https://habr.com/ru/companies/otus/articles/957982/)
>
> **Для этого настройте файл `~/.terraformrc` (в домашней папке):**
>
```
provider_installation {
  network_mirror {
    url = "https://terraform-mirror.yandexcloud.net/"
    include = ["registry.terraform.io/*/*"]
  }
  direct {
    exclude = ["registry.terraform.io/*/*"]
  }
}
```
>
> Это позволит Terraform скачивать плагины через российское зеркало и обойти блокировки.

Данный каталог содержит инфраструктурный код Terraform для автоматизации локального развёртывания учебного проекта.

## Зачем это нужно
- Автоматизация создания необходимых ресурсов для локального окружения
- Возможность воспроизвести инфраструктуру проекта на новой локальной машине

## Примеры задач для автоматизации:
- Поднятие виртуальной машины с minikube (например, через Vagrant, libvirt, Docker)
- Генерация настроек сети и проброса портов
- Создание ssh-ключей при необходимости

## Основные файлы
- `main.tf` — основной инфраструктурный код
- `variables.tf` — описание переменных
- `outputs.tf` — выходные параметры (например, IP-адреса, пути к kubeconfig)

## Как использовать
1. Установить Terraform ([официальная инструкция](https://learn.hashicorp.com/tutorials/terraform/install-cli)).
2. Настроить файл `~/.terraformrc` (см. выше), если вы видите ошибку про registry.terraform.io!
3. Зайти в каталог `infrastructure/local`
4. Инициализировать проект:
   ```bash
   terraform init
   ```
5. Просмотреть план изменений:
   ```bash
   terraform plan
   ```
6. Применить инфраструктуру:
   ```bash
   terraform apply
   ```

---

> **Внимание!** Данный каталог и все его файлы относятся только к локальному варианту. Для облачных сценариев будет отдельная структура.
